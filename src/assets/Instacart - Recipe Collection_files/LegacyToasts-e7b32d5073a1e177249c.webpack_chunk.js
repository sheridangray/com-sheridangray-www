"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3521],{40334:(t,e,n)=>{n.d(e,{Z:()=>g});var r=n(0),o=n(11),a=n(1),s=n.n(a),i=n(86237),c=n(3),u=n(87491);function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}const y={wrapEl:{alignItems:"center",display:"flex",flexDirection:"column",position:"relative"},bar:{container:{background:i.O9.WHITE,borderColor:i.O9.GREEN_500,borderRadius:25,borderStyle:"solid",borderWidth:1,display:"flex",height:8,overflow:"hidden",position:"relative",width:"100%"},fill:{backgroundColor:i.O9.GREEN_500,borderRadius:23,height:"100%",willChange:"width"}},tick:{fontSize:20,position:"absolute",right:-30,top:-6}};let b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,t);var e,n,r,o=f(a);function a(...t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,...t)).state={animatedProgress:null,animationInProgress:!1,isTransitionEnabled:!0,loops:null},e}return e=a,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(t){const{levels:e}=this.props;if(e!==t.levels){const n=t.levels-e;this.setState({animationInProgress:!0,animatedProgress:this.props.progress,loops:n})}}},{key:"componentDidUpdate",value:function(t,e){const{animationInProgress:n,loops:r}=this.state;n&&r!==e.loops&&this.animateLoopingProgressBar()}},{key:"animateLoopingProgressBar",value:function(){const{transitionRate:t,progress:e}=this.props,{loops:n}=this.state,r=n>0,o=Math.abs(n);o>0&&this.animateOneLoop(r),0===o&&this.setState({isTransitionEnabled:!0,animatedProgress:e},(()=>{setTimeout((()=>{this.resetAnimationProgress()}),t)}))}},{key:"animateOneLoop",value:function(t){const{transitionRate:e}=this.props,{loops:n}=this.state,r=t?0:1,o=t?1:0;this.setState({isTransitionEnabled:!0,animatedProgress:o},(()=>{setTimeout((()=>{this.setState({isTransitionEnabled:!1,animatedProgress:r},(()=>{setTimeout((()=>{this.setState({loops:n+(t?-1:1)})}),70)}))}),e+20)}))}},{key:"resetAnimationProgress",value:function(){this.setState({animatedProgress:null,animationInProgress:!1,loops:null})}},{key:"renderTick",value:function(){if(this.props.tickMark&&this.props.progress>=1)return(0,c.tZ)(i.JO,{name:"checkBold",style:y.tick})}},{key:"render",value:function(){const{progress:t,transitionRate:e,wrapElStyle:n,barContainerStyle:r,barFillStyle:o,disableMinFill:a=!1}=this.props,{animationInProgress:s,animatedProgress:i,isTransitionEnabled:u}=this.state,l=function(t,e){const n=e?0:.02,r=Math.min(100*Math.max(t,n),100);return parseFloat(r.toFixed(1))}(s?i:t,a);return(0,c.tZ)("div",{style:{...y.wrapEl,...n}},(0,c.tZ)("div",{style:{...y.bar.container,...r}},(0,c.tZ)("span",{style:{...y.bar.fill,...o,width:"".concat(l,"%"),transition:u&&"width ".concat(e,"ms ease-in-out")}})),this.renderTick())}}])&&l(e.prototype,n),r&&l(e,r),a}(r.PureComponent);b.propTypes={levels:s().number,progress:function(t,e){const n=t[e];return u.isNumber(n)?n<0||n>1?new Error("progress must be between ".concat(0," and ").concat(1)):void 0:new Error("progress must be a number")},tickMark:s().bool,transitionRate:s().number,wrapElStyle:s().object,barContainerStyle:s().shape({height:s().number,width:s().number,borderColor:s().string,backgroundColor:s().string}),barFillStyle:s().shape({backgroundColor:s().string}),disableMinFill:s().bool},b.defaultProps={levels:0,tickMark:!1,transitionRate:500,wrapElStyle:{}};const g=(0,o.default)(b)},42985:(t,e,n)=>{n.r(e),n.d(e,{default:()=>nt});var r,o,a,s=n(0),i=n(3946),c=n(1),u=n.n(c),l=n(51814),p=n(11),f=n(27888),d=n(6),h=n.n(d),y=n(54817),b=n(7054),g=n(29041),m=n(66612),v=n(5483),_=n(40334),w=n(22087),k=n(1886),O=n(40273),P=n(69139),R=n(3);function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T(t,e){return T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},T(t,e)}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E(t);if(e){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}const Z={showRetailerChooser:b.BO,dequeueMessage:y.zj,updateBundle:g.jG,handleServerTriggeredAction:w.pn,trackEvent:O.L};let M=(0,k.Z)(["globals.payment_method_actions","globals.coupon_redemption"])((a=o=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(a,t);var e,n,r,o=j(a);function a(...t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,...t)).renderMainContent=()=>{const{header:t,body:n,type:r,tracking_params:o}=e.props,{titleI18nKey:a,titleI18nMsg:s}=e.props;let{formatted_message:i}=e.props;const c=h()({"toast-main-content":!0,"only-header":t&&!n,"only-body":!t&&n,wrapping:e.props.wrap,"pull-left":!0});if(!i){const r=s&&!a,o=a||s;if(!t&&!n&&o&&r)return;const c=a&&!s;let u;u=a&&s?e.props.t(a).replace("%{message}",s):c?e.props.t(a):null==t?void 0:t.label,i={strings:[{value:u,attributes:["semibold"]},{value:n&&n.label,attributes:[]}]}}const u=(e.props.toast_actions||[]).map(e.retrieveAction).filter((t=>t));return u.length>0?u[0].click?(0,R.tZ)("a",{className:c,href:u[0].href,key:u[0].key,onClick:t=>{t&&t.preventDefault(),u[0].click().then((()=>{u[0].onSuccess&&u[0].onSuccess()})),"coupon_reminder"!==r?e.props.dequeueMessage({id:e.props.id,type:"clicked"}):e.props.trackEvent("coupon_reminder_toast","click",o)}},(0,R.tZ)(v.Z,{strings:i.strings}),e.renderActions()):(0,R.tZ)("a",{className:c,href:u[0].href,key:u[0].key,onClick:t=>{e.props.dequeueMessage({id:e.props.id,type:"clicked"})}},(0,R.tZ)(v.Z,{strings:i.strings}),e.renderActions()):(0,R.tZ)("div",{className:c},(0,R.tZ)(v.Z,{strings:i.strings}),e.renderProgressBar())},e.retrieveAction=(t,n)=>{if(!t)return;const{action:r}=t;switch(r.type){case"navigate_to_order":return{href:"orders/".concat(r.data.order.id),key:"".concat(n,"-").concat(r.type)};case"navigate_to_rating":return{href:"".concat(r.data.rating.rating_url,"&source_type=toast"),key:"".concat(n,"-").concat(r.type)};case"navigate_to_order_change":return{href:"".concat(window.location.origin,"/oc/").concat(r.data.order_delivery.base62_id),key:"".concat(n,"-").concat(r.type)};case"navigate_to_retailer":return{href:"".concat(window.location.origin,"/store/").concat(r.data.retailer.slug,"/storefront"),key:"".concat(n,"-").concat(r.type)};case"navigate_to_account":return{href:"".concat(window.location.origin,"/store/account/").concat(r.data.section),key:"".concat(n,"-").concat(r.type)};case"open_store_chooser":return{href:"".concat(window.location.origin,"/store/storefront"),key:"".concat(n,"-").concat(r.type),click:e.props.showRetailerChooser};case"navigate_to_url":return{href:r.data.url,key:"".concat(n,"-").concat(r.type)};case"navigate_to_pickup_status":const t=r.data.container.path.replace("next_gen/","");return{href:"".concat(window.location.origin,"/store/").concat(t),key:"".concat(n,"-").concat(r.type)};case"navigate_to_retailer_info":return{href:"".concat(r.data.retailer.slug,"/info?source_type=").concat(r.data.query_params.source_type),key:"".concat(n,"-").concat(r.type)};case"navigate_to_certified_verification":return{href:"".concat(window.location.origin,"/store/certified_delivery_verification/").concat(r.data.order_delivery_id),key:"".concat(n,"-").concat(r.type)};case"update_bundle":return{href:"".concat(window.location.origin,"/store/storefront"),key:"".concat(n,"-").concat(r.type),click:()=>e.props.updateBundle(r.data.params)};case"show_available_promos_modal":case"show_promotion_detail_modal":case"open_cart":return{href:"".concat(window.location.origin,"/store/storefront"),key:"".concat(n,"-").concat(r.type),click:()=>e.props.handleServerTriggeredAction(r)};case"send_request":return{href:"".concat(window.location.origin).concat(r.data.path),key:"".concat(n,"-").concat(r.type),click:()=>e.props.handleServerTriggeredAction(r),onSuccess:r.onSuccess}}},e}return e=a,n=[{key:"renderIconCount",value:function(){const t=this.props.icon||{},{count:e}=t;if(e)return"notification"===e.type?(0,R.tZ)("span",{className:"toast-icon-count"},e.value):void 0}},{key:"renderIconImage",value:function(){const{iconClass:t}=this.props,e=h()("ic-icon","absolute-center",t),n=this.props.icon;return n?(0,R.tZ)("img",{src:n.url,alt:n.alt,className:"absolute-center"}):t?(0,R.tZ)("i",{className:e,"aria-hidden":"true"}):void 0}},{key:"renderIcon",value:function(){if(this.props.icon||this.props.iconClass)return(0,R.tZ)("div",{className:"toast-icon pull-left"},this.renderIconImage(),this.renderIconCount())}},{key:"renderHeaderBadge",value:function(){const{badge:t}=this.props.header;if(t)return"new"===t.type?(0,R.tZ)("span",{className:"toast-header-badge new"},t.label):void 0}},{key:"renderHeader",value:function(){if(this.props.header)return(0,R.tZ)("h3",{className:"ic-truncate",title:this.props.header.label},this.renderHeaderBadge(),this.props.header.label)}},{key:"renderBodyBadge",value:function(){const{badge:t}=this.props.body;if(t)return"new"===t.type?(0,R.tZ)("span",{className:"toast-body-badge new"},t.label):void 0}},{key:"renderBody",value:function(){if(this.props.body)return(0,R.tZ)("p",{className:"ic-truncate",title:this.props.body.label},this.renderBodyBadge(),this.props.body.label)}},{key:"renderProgressBar",value:function(){const{progress:t}=this.props;if(t)return(0,R.tZ)("div",{style:{marginTop:"10px"}},(0,R.tZ)(_.Z,{progress:t}))}},{key:"renderAction",value:function(t,e){if(!t)return;const{action:n}=t;return(0,R.tZ)("button",{className:"toast-action",key:"".concat(e,"-").concat(t.label)},t.label)}},{key:"renderActions",value:function(){const t=this.props.toast_actions||[];if(!(t.length<=0)||this.props.isStatic)return(0,R.tZ)("div",{className:"toast-actions"},t.map(this.renderAction))}},{key:"renderDismissAction",value:function(){let t={display:"flex",justifyContent:"center",alignItems:"center"};return(0,P.tq)()&&(t={...t,position:"absolute",top:"5px",left:"5px"}),(0,R.tZ)("button",{className:"toast-dismiss",onClick:t=>this.props.dequeueMessage({id:this.props.id,type:"dismissed"}),"aria-label":"close toast","aria-live":"off"},(0,R.tZ)("div",{style:t},(0,R.tZ)(m.Two,{size:16})))}},{key:"render",value:function(){return(0,R.tZ)("div",{className:"default-toast-module"},this.renderMainContent(),this.renderDismissAction())}}],n&&C(e.prototype,n),r&&C(e,r),a}(s.PureComponent),o.propTypes={icon:u().object,header:u().object,titleI18nKey:u().string,titleI18nMsg:u().string,body:u().object,progress:u().number,wrap:u().bool,actions:u().array,isStatic:u().bool,iconClass:u().string,showRetailerChooser:u().func,dequeueMessage:u().func,updateBundle:u().func,type:u().string,t:u().func,trackEvent:u().func},r=a))||r;const B=(0,l.connect)(null,Z)(M);function I(){return I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},I.apply(this,arguments)}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,e){return x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},x(t,e)}function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=F(t);if(e){var o=F(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q(this,n)}}function q(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}const H={trackEvent:O.L};let L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(a,t);var e,n,r,o=D(a);function a(){return N(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"componentDidMount",value:function(){const{data:t}=this.props;t&&t.tracking_params&&this.props.trackEvent("toast","view",t.tracking_params)}},{key:"render",value:function(){const t={"toast-message":!0,static:this.props.isStatic,"animating-out":this.props.animatingOut,"hide-on-checkout":this.props.isStatic};return t[this.props.type]=!0,(0,R.tZ)("li",{className:h()(t)},(0,R.tZ)(B,I({id:this.props.id,type:this.props.type,isStatic:this.props.isStatic,iconClass:this.props.iconClass},this.props.data)))}}])&&A(e.prototype,n),r&&A(e,r),a}(s.Component);L.propTypes={type:u().string,data:u().object,isStatic:u().bool,animatingOut:u().bool,iconClass:u().string,id:u().oneOfType([u().number,u().string]),trackEvent:u().func};const z=(0,l.connect)(void 0,H)(L);var G=n(31771),W=n(64895),K=n(47210),U=n(22548);const Y=(0,l.connect)((t=>({enableHomePage:(0,G.cr)("home_on_web_enabled")(t),couponRemindToastImprovement:(0,G.cr)("coupon_remind_toast_improvement_variant_2_enabled")(t)})))((0,i.withRouter)((({enableHomePage:t,couponRemindToastImprovement:e,location:n})=>{const r=(0,l.useDispatch)();return(0,s.useEffect)((()=>{const e=K.HY.filter((t=>(0,i.matchPath)(n.pathname,t))).length>0;t&&e||(0,U.Sl)({dispatch:r})}),[r,t,e,n.pathname]),null})));function J(){return J=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J.apply(this,arguments)}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V(t,e){return V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},V(t,e)}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tt(t);if(e){var o=tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $(this,n)}}function $(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},tt(t)}let et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(a,t);var e,n,r,o=X(a);function a(...t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,...t)).state={hasRenderError:!1,error:void 0},e.isBottomSheetShowing=()=>{const{broadComplementaryMatchCache:t}=e.props;let n=!1;return t&&Object.keys(t).forEach((e=>{t[e].closedAt||(n=!0)})),n},e}return e=a,(n=[{key:"componentDidCatch",value:function(t,e){this.setState({hasRenderError:!0,error:t},(()=>{const{messages:t,staticMessages:n}=this.props;console.error("A Toast message failed to render. ToastContainer output set to null to save React DOM tree failure."),console.error(this.state.error),console.error(e),f.Z.error(this.state.error,{info:e,messages:t,staticMessages:n})}))}},{key:"shouldRenderCouponToastMessage",value:function(t){const{location:e,couponRemindToastImprovement:n}=this.props,r=K.HY.filter((t=>(0,i.matchPath)(e.pathname,t))).length>0,o=(0,i.matchPath)(e.pathname,K.uv.checkout);return!(r&&!n||r&&n&&"coupon_reminder"!==t||o&&n&&"coupon_reminder"===t)}},{key:"renderToastMessages",value:function(){return this.props.messages.map(((t,e)=>{const{type:n}=t;return this.shouldRenderCouponToastMessage(n)?(0,R.tZ)(z,J({},t,{key:"".concat(e,"-").concat(t.id)})):null}))}},{key:"renderStaticMessage",value:function(){const{canDisplayStaticToasts:t,staticMessages:e}=this.props;return t?e.map(((t,e)=>(0,R.tZ)(z,J({},t,{key:"".concat(e,"-").concat(t.id)})))):[]}},{key:"render",value:function(){const{hasRenderError:t}=this.state,e=this.renderStaticMessage();return t?null:(0,R.tZ)(s.Fragment,null,this.renderToastMessages(),e,(0,R.tZ)(Y,null))}}])&&Q(e.prototype,n),r&&Q(e,r),a}(s.PureComponent);et.propTypes={canDisplayStaticToasts:u().bool,messages:u().array,staticMessages:u().array,broadComplementaryMatchCache:u().objectOf(u().shape({closedAt:u().number}))};const nt=(0,W.kA)((0,l.connect)((t=>({messages:t.app.toast.messages.filter((t=>!t.isStatic)),staticMessages:t.app.toast.messages.filter((t=>t.isStatic)),canDisplayStaticToasts:t.app.toast.canDisplayStaticToasts,broadComplementaryMatchCache:t.models.cart.broadComplementaryMatchCache,couponRemindToastImprovement:(0,G.cr)("coupon_remind_toast_improvement_variant_2_enabled")(t)})),void 0)((0,i.withRouter)((0,p.default)(et))))}}]);